# 目录

- [_exit](#_exit)
- [exit](#exit)
- [标准I/O缓冲区](#标准i-o缓冲区)
- [文件流与文件描述符的关系](#文件流与文件描述符的关系)
  - [文件描述符](#文件描述符)
  - [文件流](#文件流)
  - [关系](#关系)


# _exit 与 exit

## _exit: <a id="_exit"></a>
- `_exit` 是一个系统调用，用于立即终止进程的执行。
- 它不执行标准 I/O 缓冲区的清理或关闭，也不执行任何 atexit 注册的函数。
- 它的原型在 `<unistd.h>` 头文件中定义。
- 调用 `_exit` 后，进程会立即终止，不会执行后续代码。

## exit：<a id="exit"></a>

- `exit` 是 C 标准库函数，用于正常终止进程的执行。
- 它执行标准 I/O 缓冲区的清理和关闭，并调用通过 atexit 注册的函数。
- 它的原型在 `<stdlib.h>` 头文件中定义。
- 调用 `exit` 后，进程会执行清理工作，然后正常退出。

# 标准I/O缓冲区 <a id="标准i-o缓冲区"></a>

- 标准I/O缓冲区是在内存中的。标准 I/O 函数（如 printf、scanf 等）通常会在内存中创建缓冲区，用于临时存储数据，以提高 I/O 操作的效率。
- 标准I/O缓冲区一般分为全缓冲、行缓冲和无缓冲三种模式：
  - 全缓冲： 当缓冲区被填满或者显式地被刷新时才进行实际的 I/O 操作。例如，当使用 printf 打印一行文本时，默认情况下是全缓冲的，直到缓冲区填满或者显示调用 fflush 或 fclose 才会进行实际的输出。
  - 行缓冲： 当遇到换行符 `\n` 时才进行实际的 I/O 操作。例如，标准输出通常是行缓冲的，因此当你使用 printf 打印一行文本时，会立即进行输出。
  - 无缓冲： 每次调用标准 I/O 函数时都会进行实际的 I/O 操作。例如，标准错误通常是无缓冲的，因此当你使用 fprintf(stderr, ...) 输出错误信息时，会立即进行输出。
- 这些缓冲区是在进程的内存空间中动态分配的，因此对于每个进程来说，标准 I/O 缓冲区都是独立的。

# 文件流与文件描述符的关系 <a id="文件流与文件描述符的关系"></a>

- 文件流（file stream）和文件描述符（file descriptor）是操作系统中处理文件 I/O 的两个概念，它们之间有一定的关系。

## 文件描述符： <a id="文件描述符"></a>>

- 文件描述符是一个整数，用于标识打开的文件或者其他 I/O 资源（如管道、套接字等）。
- 在 POSIX 系统中（如 Linux、Unix），文件描述符通常是非负整数，其中 0 表示标准输入（stdin）、1 表示标准输出（stdout）、2 表示标准错误（stderr），而其他文件描述符则是通过系统调用 open、socket 等函数获得的。
- 文件描述符在程序中通常用于进行低级别的文件 I/O 操作，例如使用 read、write 等系统调用。

## 文件流：<a id="文件流"></a>

- 文件流是 C 语言标准库提供的高级别文件 I/O 抽象。
- 在 C 语言中，文件流是通过 FILE 结构体指针表示的，它提供了一系列函数（如 fopen、fclose、fread、fwrite 等）来对文件进行操作。
- 文件流提供了缓冲、格式化输入输出等功能，使得文件操作更加方便和易用。

## 关系：<a id="关系"></a>

- 通常，文件流是建立在文件描述符之上的一个抽象层。当你在 C 语言中打开一个文件时（例如使用 fopen 函数），C 标准库会创建一个文件流，并将其与一个文件描述符关联起来。
- 标准库中的文件流函数（如 fread、fwrite 等）实际上是通过调用底层的文件描述符相关的系统调用来完成文件操作的。
- 虽然文件流和文件描述符都可以用于文件 I/O 操作，但在 C 语言中通常建议使用文件流进行文件操作，因为它提供了更高级别的抽象和更方便的操作接口，同时也更容易实现跨平台的移植性。
